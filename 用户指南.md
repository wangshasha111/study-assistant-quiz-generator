# 📚 Study Assistant - 用户指南

## 🎯 简介

Study Assistant 是一个基于 AI 的学习助手，可以：
- 📄 从 PDF 或文本中提取内容
- 📝 自动生成学习摘要
- ❓ 创建交互式测验题
- 💾 下载 PDF/TXT 格式的学习资料
- 📊 管理员可查看所有用户学习数据

---

## 🚀 快速开始

### 1. 启动应用

**方法一：双击启动（最简单）**
```bash
双击 run.command 文件
```

**方法二：命令行启动**
```bash
# 进入项目目录
cd project_study_assistant_quiz_generation

# 激活虚拟环境
source venv/bin/activate

# 启动应用
streamlit run app.py
```

应用将在浏览器中打开：`http://localhost:8501`

### 2. 基本使用流程

#### 步骤 1: 上传学习材料
- 在侧边栏选择输入方式：
  - **上传 PDF**: 上传 PDF 文件
  - **粘贴文本**: 直接粘贴文本内容

#### 步骤 2: 配置设置
- **OpenAI API Key**: 输入你的 API 密钥（或使用调试模式）
- **模型选择**: 选择 GPT 模型（默认：gpt-3.5-turbo）
- **题目数量**: 设置生成的测验题数量（3-10）
- **创造性**: 调整温度参数（0.0-1.0）

#### 步骤 3: 生成内容
点击 **🚀 Generate Summary & Quiz** 按钮

#### 步骤 4: 查看结果
- **左侧**: 📋 学习摘要
- **右侧**: 📝 交互式测验

#### 步骤 5: 完成测验
1. 选择每题的答案
2. 点击 **📤 Submit Quiz** 提交
3. 查看成绩和详细解析
4. 可选：点击 **🔄 Retake Quiz** 重做

#### 步骤 6: 下载资料
- **📄 Download as Text**: 下载 TXT 格式
- **📕 Download as PDF**: 下载 PDF 格式（包含测验结果）

---

## 🐛 调试模式（免费测试）

不需要 API Key，使用模拟数据测试所有功能。

### 启用方法
1. 在侧边栏找到 **🐛 Debug Mode**
2. 打开 **Enable Debug Mode** 开关
3. 点击 **🐛 Generate Mock Data (Debug)** 按钮

### 调试模式特点
- ✅ 无需 API Key
- ✅ 无需付费
- ✅ 即时生成结果
- ✅ 完整功能测试
- ✅ 使用 Prompt Engineering 示例数据

---

## 👤 用户功能

### 输入用户名（可选）
在侧边栏 **👤 Your Name** 输入框填写名字，方便管理员跟踪学习进度。

### 交互式测验
- **选择答案**: 点击单选按钮
- **提交测验**: 完成后点击提交
- **查看结果**:
  - ✅ 正确答案：绿色显示
  - ❌ 错误答案：红色显示，并显示正确答案
  - ⚠️ 未回答：黄色提示
- **成绩统计**:
  - 得分（X/总数）
  - 百分比
  - 已答题数
  - 等级评定（优秀/良好/继续学习）

### 切换模式
- **交互模式**（默认）: 可选择答案并提交
- **查看模式**: 直接显示所有答案

点击右上角按钮切换：
- **✏️ Take Quiz**: 切换到交互模式
- **👁️ View Mode**: 切换到查看模式

---

## 📊 管理员功能

### 登录 Admin Dashboard

1. 点击侧边栏 **📊 Admin Dashboard**
2. 输入管理员密码（默认：`admin123`）
3. 点击 **🔓 Login**

### 管理员面板功能

#### 1. 总体统计
- 总会话数
- 总生成次数
- 测验完成次数
- 平均测验分数
- 24小时活跃用户数

#### 2. 会话列表
- 查看所有用户会话
- 搜索：按会话ID、用户名、IP地址
- 筛选：显示最近N个会话
- 导出：下载 CSV 格式

#### 3. 会话详情
选择特定会话查看：
- 用户信息（用户名、IP、User Agent）
- 生成记录（时间、文件、模型、内容长度）
- 测验结果（分数、百分比、详细答案）
- 导出：下载 JSON 格式

#### 4. 登出
点击侧边栏 **🚪 Logout** 退出管理员面板

---

## 🔐 管理员密码管理

### 查看当前密码
```bash
cat .env
```

### 重置密码

**方法一：使用重置工具（推荐）**
```bash
python3 reset_admin_password.py
```
按提示输入新密码，工具会验证密码强度。

**方法二：直接编辑**
```bash
# 编辑 .env 文件
nano .env

# 修改这一行
ADMIN_PASSWORD=你的新密码

# 保存并重启应用
```

**方法三：命令行快速修改**
```bash
echo "ADMIN_PASSWORD=新密码" > .env
```

### 禁用 Admin Dashboard
```bash
# 删除或注释掉密码
echo "# ADMIN_PASSWORD=" > .env
```

---

## 💾 下载功能

### TXT 格式
- 包含完整摘要
- 包含所有测验题和答案
- 包含测验结果（如果已完成）
- 格式化的文本，易于阅读

### PDF 格式
- 专业排版
- 彩色标记（正确/错误答案）
- 突出显示测验结果
- 包含时间戳
- 可打印、可分享

---

## ❓ 常见问题

### Q: 忘记管理员密码怎么办？
A: 查看 .env 文件：`cat .env`

### Q: 如何免费测试功能？
A: 启用调试模式，无需 API Key

### Q: 测验提交后还能修改吗？
A: 可以点击 "🔄 Retake Quiz" 重新作答

### Q: 下载的文件包含测验结果吗？
A: 是的，如果已提交测验，下载文件会包含详细结果

### Q: 可以切换中英文吗？
A: 当前版本为中文界面，英文版请参考 README_EN.md

### Q: 如何停止应用？
A: 在运行 Streamlit 的终端按 `Ctrl+C`

### Q: 为什么无法访问 Admin Dashboard？
A: 需要设置 ADMIN_PASSWORD 环境变量

### Q: 数据存储在哪里？
A: SQLite 数据库文件：`study_assistant.db`

---

## 🔧 故障排除

### 问题：ModuleNotFoundError

**解决方案：**
```bash
# 激活虚拟环境
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

### 问题：端口被占用

**解决方案：**
```bash
# 查找占用端口的进程
lsof -ti:8501

# 终止进程
kill -9 $(lsof -ti:8501)

# 或使用其他端口
streamlit run app.py --server.port 8502
```

### 问题：Admin Dashboard 报错

**解决方案：**
```bash
# 检查密码是否设置
cat .env

# 重置密码
python3 reset_admin_password.py
```

### 问题：API Key 错误

**解决方案：**
1. 使用调试模式测试
2. 检查 API Key 是否正确
3. 确认 OpenAI 账户有余额

### 更多问题？
查看完整故障排除文档或重新安装：
```bash
# 完全重置
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
streamlit run app.py
```

---

## 📋 快速命令参考

```bash
# 启动应用
source venv/bin/activate && streamlit run app.py

# 测试配置
python3 test_admin_config.py

# 重置密码
python3 reset_admin_password.py

# 停止应用
按 Ctrl+C

# 查看管理员密码
cat .env

# 安装依赖
pip install -r requirements.txt
```

---

## 📞 获取帮助

- **技术文档**: `技术文档.md`
- **英文版**: `USER_GUIDE_EN.md`
- **项目主页**: README.md

---

**版本**: 1.0  
**最后更新**: 2025年10月19日  
**支持**: Python 3.8+, Streamlit 1.29.0+
